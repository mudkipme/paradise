<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title><%= t('app.pokemon-paradise') %></title>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <link href="/stylesheets/main.css" rel="stylesheet" />
    <link rel="apple-touch-icon-precomposed" href="/images/apple-icon.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-icon-ipad.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-icon.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-icon-ipad.png" />
    <link rel="apple-touch-startup-image" href="/images/apple-startup.png" media="(device-width: 320px) and (device-height: 480px)" />
    <link rel="apple-touch-startup-image" href="/images/apple-startup-iphone5.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" />
    <link rel="apple-touch-startup-image" href="/images/apple-startup-ipad-portrait.png" media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait)" />
    <link rel="apple-touch-startup-image" href="/images/apple-startup-ipad.png" media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape)" />

    <script>
      if (!("ontouchstart" in document.documentElement)) {
        document.documentElement.className += " no-touch";
      }
      var PARADISE = {
        imgBase: '<%= config.app.imgBase %>'
        ,locale: '<%= i18n.lng() %>'
        ,me: <%- JSON.stringify(me) -%>
      };
    </script>
    <% if (settings.env == 'development') { %>
      <script data-main="/javascripts/main" src="/components/requirejs/require.js"></script>
    <% } else { %>
      <script src="/javascripts/main-built.js"></script>
    <% } %>
  </head>
  <body>
    
    <nav class="navbar">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-52poke-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://bbs.52poke.com/"><%= t('app.pokemon-zone') %></a>
        </div>

        <div class="collapse navbar-collapse navbar-52poke-collapse">
          <ul class="nav navbar-nav">
            <li class="hidden-sm"><a href="http://bbs.52poke.com/"><%= t('app.forum') %></a></li>
            <li><a href="http://www.52poke.com/"><%= t('app.main-page') %></a></li>
            <li><a href="http://wiki.52poke.com/"><%= t('app.wiki') %></a></li>
            <li class="active"><a href="/"><%= t('app.pokemon-paradise') %></a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"><%= t('forum.apps') %> <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <% _.each(config.bbs.apps, function(url, name){ %>
                  <li><a href="<%= url %>"><%= t('forum.'+name) %></a></li>
                <% }) %>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"><%= t('forum.view') %> <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="http://bbs.52poke.com/misc.php?p=viewnews"><%= t('forum.viewnews') %></a></li>
                <li><a href="http://bbs.52poke.com/misc.php?p=top"><%= t('forum.viewtop') %></a></li>
                <li><a href="http://bbs.52poke.com/userlist.php"><%= t('forum.userlist') %></a></li>
                <li><a href="http://bbs.52poke.com/search.php?keyword=<%= encodeURIComponent(member.username) %>&amp;method=or&amp;method1=2&amp;method2=7"><%= t('forum.my-topic') %></a></li>
                <li><a href="http://bbs.52poke.com/search.php?keyword=<%= encodeURIComponent(member.username) %>&amp;method=or&amp;method1=3&amp;method2=7"><%= t('forum.my-reply') %></a></li>
              </ul>
            </li>
          </ul>

          <ul class="nav navbar-nav navbar-right">
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"><%= member.username %> <span class="hide badge"></span> <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li class="dropdown-header"><%= t('app.msg') %></li>
                <li><a href="/msg"><span class="badge pull-right hide"></span><%= t('app.my-msg') %></a></li>
                <li><a href="http://bbs.52poke.com/messenger.php?job=receivebox"><%= t('forum.primsg') %></a></li>
                <li class="divider"></li>
                <li class="dropdown-header"><%= t('app.language') %></li>
                <li><a class="switch-language" data-language="zh-hans" href="#">简体中文</a></li>
                <li><a class="switch-language" data-language="zh-hant" href="#">繁體中文</a></li>
                <li><a class="switch-language" data-language="en" href="#">English</a></li>
                <li class="divider"></li>
                <li><a href="http://bbs.52poke.com/usercp.php"><%= t('forum.usercp') %></a></li>
                <li><a href="http://bbs.52poke.com/profile.php"><%= t('forum.profile') %></a></li>
                <li><a href="http://bbs.52poke.com/viewfav.php"><%= t('forum.viewfav') %></a></li>
                <li><a href="http://bbs.52poke.com/misc.php?p=account"><%= t('forum.bind-account') %></a></li>
                <li class="divider"></li>
                <li><a href="http://bbs.52poke.com/login.php"><%= t('forum.re-login') %></a></li>
                <li><a href="http://bbs.52poke.com/login.php?job=quit&amp;verify=<%= member.logHash %>"><%= t('forum.logout') %></a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container">
      <div id="browser-error" class="alert alert-danger" style="display:none">
        <h4><%= t('app.incompatible-browser') %></h4>
        <ul>
          <li><a href="http://www.google.com/chrome/">Google Chrome</a> 28</li>
          <li><a href="http://www.mozilla.org/">Mozilla Firefox</a> 22</li>
          <li><a href="http://www.beautyoftheweb.com/">Internet Explorer</a> 10</li>
          <li><a href="http://www.apple.com/safari/">Safari</a> 6</li>
          <li><a href="http://www.opera.com/">Opera</a> 15</li>
          <li><a href="http://www.apple.com/ios/whats-new/#safari">Safari for iOS</a> 6</li>
          <li><a href="http://www.google.com/intl/en/chrome/browser/mobile/">Chrome for Mobile</a></li>
        </ul>
      </div>
      
      <div id="paradise-alert"></div>

      <section id="paradise-app">
        <main></main>
        <aside></aside>
      </section>

      <hr />
      <footer>
        <p>
          &copy; 2005-<%= new Date().getFullYear() %> <a href="http://bbs.52poke.com/"><%= t('app.pokemon-zone') %></a>
        </p>
      </footer>
    </div>
    
    <div id="paradise-modal"></div>
    
    <script>
      /* Disable legacy browsers */
      var features;
      (function(s, features) {
        features.transitions = 'transition' in s || 'webkitTransition' in s || 'MozTransition' in s || 'msTransition' in s || 'OTransition' in s;
      })(document.createElement('div').style, features || (features = {}));

      if (!document.createElement('canvas').getContext || !features.transitions) {
        document.getElementById('browser-error').style.display = 'block';
        document.getElementById('paradise-app').style.display = 'none';
      }

      /* viewport fix for Windows Phone 8 */
      if (navigator.userAgent.match(/IEMobile\/10\.0/)) {
        var msViewportStyle = document.createElement("style");
        msViewportStyle.appendChild(
          document.createTextNode('@-ms-viewport{width:auto!important}')
        );
        document.getElementsByTagName("head")[0].appendChild(msViewportStyle);
      }
    </script>
  </body>
</html>